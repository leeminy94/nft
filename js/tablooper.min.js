(function(e){var t=function(t,n){function g(){var n=0;var r=e(t).find(".loop-tabctrl").width();n=o-r-10;i.css({width:n+"px"});i.find(".loop-tab").addClass("loop-inactivetab")}function y(n,r){var s;i.find(".loop-tab").removeClass("loop-activetab");i.find("div[data-tabindex='"+r+"']").addClass("loop-activetab");if(h!="prev"){var o=i.find(".loop-activetab");var u=i.find(".loop-tab").index(o);if(u>1){for(var a=0;a<u;a++){i.find(".loop-tab").eq(0).appendTo(e(t).find(".loop-tabstation"))}}else{s=i.find(".loop-activetab").prev();s.appendTo(e(t).find(".loop-tabstation"))}}else{s=i.find(".loop-activetab");s.appendTo(e(t).find(".loop-tabstation"))}}function b(){if(e(t).find(".loop-tabstation").find(".loop-tab").length){var n=e(t).find(".loop-tabstation").contents();if(h!="prev"){e(t).find(".loop-tabholder").append(n)}else{e(t).find(".loop-tabholder").prepend(n)}}}function w(n,r){i.find(".loop-tab").addClass("loop-inactivetab");d=i.find(".loop-tab").eq(0).attr("data-tabid");var s=e(t).find(".loop-contentzone").find('div[data-tabid="'+d+'"]');var u;var a;var f;if(h=="next"){u="fade";u="swing";$DurationIn=200}else if(h=="prev"){u="fade";u="swing";$DurationIn=200}else{u=s.attr("data-efout");if(u===undefined){u="fade"}f=s.attr("data-esout");if(f===undefined){f="swing"}a=s.attr("data-durout");if(a===undefined){a=200}a=parseInt(a)}if(u=="movetoleft"){s.animate({left:"-"+o+"px"},a,f,function(){s.css({left:"0px",display:"none"});y(n,r);E(r)})}else if(u=="movetoright"){s.animate({left:o+"px"},a,f,function(){s.css({left:"0px",display:"none"});y(n,r);E(r)})}else if(u=="slide"){s.slideUp(a,f,function(){y(n,r);E(r)})}else{s.fadeOut(a,f,function(){y(n,r);E(r)})}}function E(n){function u(){var e;var t;var n;if(h=="next"){e="movetoleft";n="swing";t=200;h="none"}else if(h=="prev"){e="movetoright";n="swing";t=200;h="none"}else{e=s.attr("data-efin");if(e===undefined){e="fade"}n=s.attr("data-esin");if(n===undefined){n="swing"}t=s.attr("data-durin");if(t===undefined){t=200}t=parseInt(t)}if(e=="movetoleft"){s.css({left:o+"px",display:"block"});s.animate({left:"0"},t,n,function(){v=false})}else if(e=="movetoright"){s.css({left:"-"+o+"px",display:"block"});s.animate({left:"0"},t,n,function(){v=false})}else if(e=="slide"){s.slideDown(t,n,function(){v=false})}else{s.fadeIn(t,n,function(){v=false})}}b();i.find(".loop-activetab").removeClass("loop-inactivetab");d=i.find(".loop-tab").eq(0).attr("data-tabid");var s=e(t).find(".loop-contentzone").find('div[data-tabid="'+d+'"]');if(!s.length){e.ajax({url:"content/tablooper/"+d+"."+r.ext,type:"POST",cache:false,success:function(n){if(n){e(t).find(".loop-contentzone").append(n);s=e(t).find(".loop-contentzone").find('div[data-tabid="'+d+'"]');u()}},error:function(e){alert(r.errormes)}})}else{u()}a=n+1;e(t).find(".loop-tabctrl").find(".loop-tabnum").find(".loop-curindex").empty();e(t).find(".loop-tabctrl").find(".loop-tabnum").find(".loop-curindex").append(a);h="none";l=n}function S(n){if(!e(n).hasClass("loop-activetab")){if(v==false){v=true;l=i.find(".loop-activetab").attr("data-tabindex");l=parseInt(l);$newView=e(n).attr("data-tabindex");$newView=parseInt($newView);w(l,$newView)}}else{if(r.EnableHide==true){e(n).removeClass("loop-activetab");e(t).find(".loop-contentzone").find(".loop-content").slideUp(400)}}}function x(){if(v==false){v=true;p["left"]="-"+o+"px";h="next";l=parseInt(l);e(t).find(".loop-contentzone").animate(p,200,"swing",function(){i.find(".loop-tab").removeClass("loop-activetab");e(t).find(".loop-contentzone").find('div[data-tabid="'+d+'"]').css({display:"none"});if(l<f){$newView=l+1;w(l,$newView)}else if(l>=f){$newView=0;w(l,$newView);l=0}e(t).find(".loop-contentzone").css({left:"0px"})})}}function T(){if(v==false){v=true;p["left"]=o+"px";h="prev";l=parseInt(l);e(t).find(".loop-contentzone").animate(p,200,"swing",function(){i.find(".loop-tab").removeClass("loop-activetab");e(t).find(".loop-contentzone").find('div[data-tabid="'+d+'"]').css({display:"none"});if(l>0){$newView=l-1;w(l,$newView)}else if(l==0){$newView=f;w(l,$newView);l=f}e(".loop-contentzone").css({left:"0px"})})}}function N(){y(-1,0);i.find(".loop-activetab").removeClass("loop-inactivetab");if(r.HideContentTab==false){e(t).find(".loop-contentzone").find('div[data-tabid="'+d+'"]').css({display:"block"})}else{e(t).find(".loop-contentzone").find('div[data-tabid="'+d+'"]').css({display:"none"});i.find(".loop-tab").removeClass("loop-activetab");i.find(".loop-tab").addClass("loop-inactivetab")}e(t).find(".loop-tabctrl").find(".loop-tabnum").find(".loop-curindex").append(a);i.find(".loop-tab").on("click",function(){S(this)});e(t).find(".loop-tabzone").find(".loop-nextbt").on("click",function(){x()});e(t).find(".loop-tabzone").find(".loop-prevbt").on("click",function(){T()});if(r.EnableKeys==true){e(document).keydown(function(e){if(e.keyCode==37){T();return false}else if(e.keyCode==39){x();return false}})}if(r.EnableSwipe==true){e(t).find(".loop-contentzone").on("swipeleft",function(){x()});e(t).find(".loop-contentzone").on("swiperight",function(){T()})}i.find(".loop-tab").hover(function(){if(!e(this).hasClass("loop-activetab")){e(this).removeClass("loop-inactivetab")}},function(){if(!e(this).hasClass("loop-activetab")){e(this).addClass("loop-inactivetab")}})}function k(e,t){var n,t=t||200;return function(){var r=this,i=arguments;clearTimeout(n);n=setTimeout(function(){e.apply(r,Array.prototype.slice.call(i))},t)}}var r=e.extend({},e.fn.looptab.defaults,n);var i=e(t).find(".loop-tabzone").find(".loop-tabholder");var s=e(t).find(".loop-tabholder").find(".loop-tab").length;e(t).find(".loop-tabctrl").find(".loop-tabnum").find(".loop-tabtotal").append(s);var o=e(t).width();var u;var a=1;var s;var f=s-1;var l=0;var c;var h;var p={};var d=e(t).find(".loop-tabzone").find(".loop-tabholder").find(".loop-tab").eq(0).attr("data-tabid");var v=false;for(var m=0;m<s;m++){i.find(".loop-tab").eq(m).attr("data-tabindex",m)}if(!e(t).find(".loop-tabstation").length){e(t).append("<div class='loop-tabstation'></div>")}e(t).find(".loop-tabstation").css({display:"none"});g();N();var C=e(window).width();e(window).resize(k(function(){var n=e(window).width();if(C!=n){o=e(t).width();g();i.find(".loop-activetab").removeClass("loop-inactivetab")}C=n}))};e.fn.looptab=function(n){return this.each(function(r,i){if(e(this).data("looptab"))return e(this).data("looptab");var s=new t(this,n);e(this).data("looptab",s)})};e.fn.looptab.defaults={ext:"php",errormes:"Error: Content not exist!",EnableSwipe:true,EnableKeys:false,EnableHide:false,HideContentTab:false}})(jQuery);